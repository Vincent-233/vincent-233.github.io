<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>倒水问题 - 人生短短几個秋</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="人生短短几個秋" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">人生短短几個秋</div>
					<div class="logo__tagline">实践是最好的成长，发表是最好的回忆</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/">
				
				<span class="menu__text">首页</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/tech/">
				
				<span class="menu__text">技术笔记</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/tools/">
				
				<span class="menu__text">工具技巧</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/thinking/">
				
				<span class="menu__text">生活随想</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/archive">
				
				<span class="menu__text">归档</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/about">
				
				<span class="menu__text">关于</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">倒水问题</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2013-07-23T13:50:40Z">2013-07-23</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" rel="category">数据结构与算法</a>
	</span>
</div></div>
		</header>
		<div class="content post__content clearfix">
			<p>今日又试著刷了一道CSDN英雄会的题，可惜挑战失败，但不管怎样，在寻求解决方案的过程中也是有不少收获的。</p>
<p>有两个容器，容积分别为A升和B升，有无限多的水，现在需要C升水。 我们还有一个足够大的水缸，足够容纳C升水。起初它是空的，我们只能往水缸里倒入水，而不能倒出。 可以进行的操作是： 把一个容器灌满； 把一个容器清空（容器里剩余的水全部倒掉，或者倒入水缸）； 用一个容器的水倒入另外一个容器，直到倒出水的容器空或者倒入水的容器满。</p>
<p>问是否能够通过有限次操作，使得水缸最后恰好有C升水。 输入：三个整数A, B, C，其中 0 &lt; A , B, C</p>
<p>我想到了题目的关键在于判断 AX + BY = C 有整数解，却没想到 X 和 Y 有可能为负。当然我也没有很简洁地给出议程有解的条件。后来查找了相关资料后发现上述方程有解的充要条件就是：C % gcd(A , B) == 0 ，即C可被 A 与 B 的最大公约数整除。</p>
<p>于是可写如下判断函数：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">int</span> <span style="color:#00a000">gcd</span>(<span style="color:#0b0;font-weight:bold">int</span> a, <span style="color:#0b0;font-weight:bold">int</span> b)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#a2f;font-weight:bold">return</span> a <span style="color:#666">==</span> <span style="color:#666">0</span> <span style="color:#666">?</span> <span style="color:#a0a000">b</span> : gcd(b <span style="color:#666">%</span> a, a);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#0b0;font-weight:bold">bool</span> <span style="color:#00a000">can</span>(<span style="color:#0b0;font-weight:bold">int</span> a, <span style="color:#0b0;font-weight:bold">int</span> b, <span style="color:#0b0;font-weight:bold">int</span> c)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">return</span> c <span style="color:#666">%</span> gcd(a, b) <span style="color:#666">==</span> <span style="color:#666">0</span> <span style="color:#666">?</span> <span style="color:#a2f">true</span> <span style="color:#666">:</span> <span style="color:#a2f">false</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>倒水问题的经典形式是这样的：</p>
<p>&ldquo;假设有一个池塘，里面有无穷多的水。现有2个空水壶，容积分别为5升和6升。问题是如何只用这2个水壶从池塘里取得3升的水。&rdquo;</p>
<p>当然题外是有一些合理的限制的，比如从池塘里灌水的时候，不管壶里是不是已经有水了，壶一定要灌满，不能和另一个壶里的水位比照一下&quot;毛估估&quot;（我们可以假设壶是不透明的，而且形状也不同）；同样的，如果要把水从壶里倒进池塘里，一定要都倒光；如果要把水从一个壶里倒进另一个壶里，也要都倒光，除非在倒的过程中另一个壶已经满了；倒水的时候水没有损失（蒸发溢出什么的）等等等等。</p>
<p>事实上，要解决上面这题，你只要用两个壶中的其中一个从池塘里灌水，不断地倒到另一个壶里，当第二个壶满了的时候，把其中的水倒回池塘里，反复几次，就得到答案了。以5升壶(A)灌6升壶(B)为例：</p>
<p>A B<br>
0 0<br>
5 0 A→B<br>
0 5<br>
5 5 A→B<br>
4 6<br>
4 0 A→B<br>
0 4<br>
5 4 A→B<br>
3 6</p>
<p>现在我们问，如果是多于2只壶的情况怎么办（这样一来就不能用上面的循环倒水法了）？如何在倒水之前就知道靠这些壶是一定能（或一定不能）倒出若干升水来的？试举数例：</p>
<ol>
<li>两个壶：65升和78升，倒38升和39升。</li>
<li>三个壶：6升，10升和45升，倒31升。</li>
</ol>
<p>我们可以看到，在1)中，65=5×13，78=6×13，而39=3×13。所以如果把13升水看作一个单位的话（原题中的&quot;升&quot;是没有什么重要意义的，你可以把它换成任何容积单位，毫升，加仑——或者&quot;13升&quot;），这题和最初的题目是一样的。而38升呢？显然是不可能的，它不是13的倍数，而65升和78升的壶怎么也只能倒出13升的倍数来。也可以这样理解：这相当于在原题中要求用5升和6升的壶倒出38/39升来。</p>
<p>那么2)呢？你会发现，只用任何其中两个壶是倒不出31升水的，理由就是上面所说的，(6,10)=2，(6,45)=3，(10,45)=5，（这里(a,b)是a和b的最大公约数），而2，3，5均不整除31。可是用三个壶就可以倒出31升：用10升壶四次，6升壶一次灌45升壶，得到1升水，然后灌满10升壶三次得30升水，加起来为31升。</p>
<p>一般地我们有&quot;灌水定理&quot;：</p>
<p>&ldquo;如果有n个壶容积分别为A1，A2，&hellip;&hellip;，An（Ai均为大于0的整数）设w为另一大于0的整数。则用此n个壶可倒出w升水的充要条件为：</p>
<ol>
<li>w小于等于A1+A2+&hellip;&hellip;+An；</li>
<li>w可被(A1,A2,&hellip;&hellip;,An)（这n个数的最大公约数）整除。&rdquo;</li>
</ol>
<p>这两个条件都显然是必要条件，如果1)不被满足的话，你连放这么多水的地方都没有。2)的道理和上面两个壶的情况完全一样，因为在任何步骤中，任何壶中永远只有(A1,A2,&hellip;&hellip;,An)的倍数的水。</p>
<p>现在我们来看一下充分性。在中学里我们学过，如果两个整数a和b互素的话，那么存在两个整数u和v，使得ua+vb=1。证明的方法很简单：在对a和b做欧几里德辗转相除时，所有中间的结果，包括最后得到的结果显然都有ua+vb的形式（比如第一步，假设a小于b，记a除b的结果为s，余数为t，即b=sa+t，则t=(-s)a+b，即u=-s，v=1）。而两个数互素意味着欧几里德辗转相除法的最后一步的结果是1，所以1也可以记作ua+vb的形式。稍微推广一点，如果(a,b)=c，那么存在u和v使得ua+vb=c（两边都除以c就回到原来的命题）。</p>
<p>再推广一点，如果A1，A2，&hellip;&hellip;，An是n个整数，(A1,A2,&hellip;&hellip;,An)=s，那么存在整数U1，U2，&hellip;&hellip;，Un，使得</p>
<p>U1A1 + U2A2 + &hellip;&hellip; + UnAn = s. (*)</p>
<p>在代数学上称此结果为&quot;整数环是主理想环&quot;。这也不难证，只要看到</p>
<p>(A1,A2,A3,A4,&hellip;&hellip;,An) = ((((A1,A2),A3),A4),&hellip;&hellip;,An).</p>
<p>也就是说，可以反复应用上一段中的公式：比如三个数a，b，c，它们的最大公约数是d。假设(a,b)=e，那么(e,c)=((a,b),c)=d。现在有u1，u2使得u1a+u2b=e，又有v1，v2使得v1e+v2c=d，那么</p>
<p>(v1u1)a+(v1u2)b+(v2)c=d.</p>
<p>好，让我们回头看&quot;灌水定理&quot;。w是(A1,A2,&hellip;&hellip;,An)的倍数，根据上节的公式(*)，两边乘以这个倍数，我们就有整数V1，V2，&hellip;&hellip;，Vn使得 V1A1 + V2A2 + &hellip;&hellip; + VnAn = w.注意到Vi是有正有负的。</p>
<p>这就说明，只要分别把A1，A2，&hellip;&hellip;，An壶，灌上V1，V2，&hellip;&hellip;，Vn次（如果Vi是负的话，&ldquo;灌上Vi次&quot;要理解成&quot;倒空-Vi次&rdquo;），就可以得到w升水了。具体操作上，先求出各Vi，然后先往Vi是正数的壶里灌水，灌1次就把Vi减1。再把这些水到进Vi是负数的壶里，等某个壶灌满了，就把它倒空，然后给这个负的Vi加1，壶之间倒来倒去不变更各Vi的值。要注意的是要从池塘里灌水，一定要用空壶灌，要倒进池塘里的水，一定要是整壶的。这样一直到所有Vi都是0为止。</p>
<p>会不会发生卡住了，既不能灌水又不能倒掉的情况？不会的。如果有Vi仍旧是负数，而Ai壶却没满：那么如果有其它Vi是正的壶里有水的话，就都倒给它；如果有其它Vi是正的壶里没水，那么就拿那个壶打水来灌（别忘了给打水的壶的Vi减1）；如果根本没有任何Vi是正的壶了——这是不可能的，这意味着w是负的。有Vi仍旧是正数，而Ai壶却没满的情况和这类似，你会发现你要用到定理中的条件1)。</p>
<p>这样&quot;灌水定理&quot;彻底得证。当然，实际解题当中如果壶的数目和容积都比较大的话，手工来找(<em>)中的各Ui比较困难，不过可以写个程序，连倒水的步骤都算出来。最后要指出的一点是，(</em>)中的Ui不是唯一的，所以倒水的方式也不是唯一的。</p>
<p><strong>PS：数学还是蛮重要的。</strong></p>

		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/2013/07/07/9263455/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">面试逻辑题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/2013/07/27/9532985/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SQL练习题（2）</p>
		</a>
	</div>
</nav>


			</div>
			<aside class="sidebar">
<div class="widget-recent widget">
	<h4 class="widget__title">近期文章</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/2025/08/13/oracle_docker_install_ubuntu/">Ubuntu通过Docker安装Oracle 12c并配置DBeaver连接</a></li>
			<li class="widget__item"><a class="widget__link" href="/2025/07/11/rustdesk-setup/">RustDesk自建Server搭建</a></li>
			<li class="widget__item"><a class="widget__link" href="/2025/05/01/how_to_read/">如何阅读一本书</a></li>
			<li class="widget__item"><a class="widget__link" href="/2025/03/23/mssql_two_common_set_option/">SQL Server中几个重要的SET OPTION，非必要不建议修改</a></li>
			<li class="widget__item"><a class="widget__link" href="/2025/03/11/soft_router_usage/">OpenWrt安装代理软件</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
  <h4 class="widget__title">分类</h4>
  <div class="widget__content">
    <ul class="widget__list">

      

      
          <li class="widget__item">
            <a class="widget__link" href="/categories/sql-server/">SQL Server</a>&nbsp;
            <span class="widget__counter widget__counter--bubble">33</span>
          </li>
          <li class="widget__item">
            <a class="widget__link" href="/categories/etl/">ETL</a>&nbsp;
            <span class="widget__counter widget__counter--bubble">9</span>
          </li>
          <li class="widget__item">
            <a class="widget__link" href="/categories/python/">Python</a>&nbsp;
            <span class="widget__counter widget__counter--bubble">18</span>
          </li>
          <li class="widget__item">
            <a class="widget__link" href="/categories/oracle/">Oracle</a>&nbsp;
            <span class="widget__counter widget__counter--bubble">4</span>
          </li>
          <li class="widget__item">
            <a class="widget__link" href="/categories/bigdata/">BigData</a>&nbsp;
            <span class="widget__counter widget__counter--bubble">3</span>
          </li>
          <li class="widget__item">
            <a class="widget__link" href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/">环境配置</a>&nbsp;
            <span class="widget__counter widget__counter--bubble">16</span>
          </li>

      
        <li class="widget__item">
          <a class="widget__link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BC%80%E5%8F%91/">数据库开发</a>&nbsp;
          <span class="widget__counter widget__counter--bubble">46</span>
        </li>
        <li class="widget__item">
          <a class="widget__link" href="/categories/%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%84%9A%E6%9C%AC/">命令行脚本</a>&nbsp;
          <span class="widget__counter widget__counter--bubble">10</span>
        </li>
        <li class="widget__item">
          <a class="widget__link" href="/categories/linux/">Linux</a>&nbsp;
          <span class="widget__counter widget__counter--bubble">5</span>
        </li>
        <li class="widget__item">
          <a class="widget__link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/">数据结构与算法</a>&nbsp;
          <span class="widget__counter widget__counter--bubble">5</span>
        </li>
        <li class="widget__item">
          <a class="widget__link" href="/categories/%E6%9D%82%E9%A1%B9/">杂项</a>&nbsp;
          <span class="widget__counter widget__counter--bubble">4</span>
        </li>

    </ul>
  </div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">标签</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/batch/" title="Batch">Batch (3)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cheat-sheet/" title="cheat sheet">cheat sheet (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/clr/" title="CLR">CLR (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/db-api/" title="DB-API">DB-API (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/docker/" title="Docker">Docker (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/dotnet/" title="dotnet">dotnet (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/duckdb/" title="DuckDB">DuckDB (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/excel/" title="Excel">Excel (4)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/git/" title="GIT">GIT (5)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/linux/" title="Linux">Linux (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/mac/" title="Mac">Mac (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/mssql/" title="MSSQL">MSSQL (26)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/openwrt/" title="OpenWrt">OpenWrt (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/oracle/" title="ORACLE">ORACLE (4)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pandas/" title="pandas">pandas (2)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pl/sql/" title="PL/SQL">PL/SQL (4)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/postgresql/" title="PostgreSQL">PostgreSQL (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/powershell/" title="powershell">powershell (6)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/python/" title="python">python (22)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/reading/" title="Reading">Reading (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/redshift/" title="RedShift">RedShift (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rustdesk/" title="RustDesk">RustDesk (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/selenium/" title="selenium">selenium (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/spark/" title="spark">spark (3)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ssh/" title="SSH">SSH (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ssis/" title="SSIS">SSIS (5)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ssms/" title="SSMS">SSMS (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/t-sql/" title="T-SQL">T-SQL (33)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/tools/" title="Tools">Tools (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ubuntu/" title="ubuntu">ubuntu (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vba/" title="VBA">VBA (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vim/" title="vim">vim (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/virtual-box/" title="virtual box">virtual box (1)</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/windows/" title="windows">windows (4)</a>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2025 人生短短几個秋.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>